## Executar Pipe Raw
gcloud dataflow flex-template run "pipeline-raw-test-$(date +%Y%m%d-%H%M%S)" \
    --template-file-gcs-location="gs://bk-etl-hotelaria/templates/pipeline_hotelaria_RAW.json" \
    --region=us-central1 \
    --parameters=bq_project_id=etl-hoteis \
    --parameters=bq_dataset=raw_hotelaria \
    --staging-location=gs://bk-etl-hotelaria/temp

## Executar Pipe Trusted
gcloud dataflow flex-template run "pipeline-trusted-test-$(date +%Y%m%d-%H%M%S)" \
    --template-file-gcs-location="gs://bk-etl-hotelaria/templates/pipeline_hotelaria_TRUSTED.json" \
    --region=us-central1 \
    --parameters=bq_project_id=etl-hoteis \
    --parameters=bq_dataset=trusted_hotelaria \
    --staging-location=gs://bk-etl-hotelaria/temp


#--->>> Conceder as seguintes permições na conta de serviço
roles/dataflow.admin
roles/dataflow.worker
roles/storage.objectAdmin
roles/artifactregistry.reader

#--->> Set project
gcloud auth application-default set-quota-project etl-hoteis

gcloud artifacts repositories create etl-process-hoteis \
    --repository-format=docker \
    --location=us-central1


gcloud auth configure-docker us-central1-docker.pkg.dev


#--->>> Sempre que alterar algo, precisa executar os comandos abaixo novamente

gcloud builds submit --tag us-central1-docker.pkg.dev/etl-hoteis/meu-repo-dataflow/etl-processing-hoteis-base:latest .


#--->>> Subnet
https://www.googleapis.com/compute/v1/projects/etl-hoteis/regions/us-central1/subnetworks/vpc-etl-hoteis


#--->>> Executar só quando for utilizar o modelo com arquivo json

gcloud dataflow flex-template build gs://dataflow-flex-model/templates//etl-process-hoteis.json \
 --image-gcr-path "us-central1-docker.pkg.dev/etl-hoteis/etl-process-hoteis/etl-hoteis-dev:latest" \
 --sdk-language "PYTHON" \
 --flex-template-base-image "PYTHON3" \
 --metadata-file "metadata.json" \
 --py-path "." \
 --env "FLEX_TEMPLATE_PYTHON_PY_FILE=main.py" \
 --env "FLEX_TEMPLATE_PYTHON_REQUIREMENTS_FILE=requirements.txt"



gcloud dataflow flex-template build gs://etl-postgres-mss/templates/etl-process-hoteis.json \
    --image="us-central1-docker.pkg.dev/etl-hoteis/etl-process-hoteis/etl-hoteis-dev:latest" \
    --sdk-language "PYTHON" 